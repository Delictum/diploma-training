unit Unit2;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, DBXMySQL, Data.FMTBcd, Data.DB,
  Vcl.Grids, Vcl.DBGrids, Datasnap.DBClient, Datasnap.Provider, Data.SqlExpr,
  Vcl.Menus, Vcl.StdCtrls;

type
  TFormAir = class(TForm)
    SQLConnection1: TSQLConnection;
    SQLQuery1: TSQLQuery;
    DataSetProvider1: TDataSetProvider;
    ClientDataSet1: TClientDataSet;
    DataSource1: TDataSource;
    DBGrid1: TDBGrid;
    DataSource2: TDataSource;
    ClientDataSet2: TClientDataSet;
    DataSetProvider2: TDataSetProvider;
    SQLQuery2: TSQLQuery;
    SQLQuery3: TSQLQuery;
    DataSetProvider3: TDataSetProvider;
    ClientDataSet3: TClientDataSet;
    DataSource3: TDataSource;
    DBGrid2: TDBGrid;
    DBGrid3: TDBGrid;
    MainMenu1: TMainMenu;
    MMProgram: TMenuItem;
    MMUserOut: TMenuItem;
    MMExitProg: TMenuItem;
    MMAED: TMenuItem;
    MMAdd: TMenuItem;
    MMEdd: TMenuItem;
    MMDel: TMenuItem;
    MMHelp: TMenuItem;
    BtnAllAir: TButton;
    BtnAllFlights: TButton;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure MMExitProgClick(Sender: TObject);
    procedure MMUserOutClick(Sender: TObject);
    procedure MMAddClick(Sender: TObject);
    procedure BtnAllAirClick(Sender: TObject);
    procedure BtnAllFlightsClick(Sender: TObject); //При закрытии программы также закрываем форму авторизации
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FormAir: TFormAir;

implementation

{$R *.dfm}

uses Unit1, Unit3;

//Показывает самолеты по принадлежности к компании или все
procedure TFormAir.BtnAllAirClick(Sender: TObject);
begin
  if BtnAllAir.Caption = 'Все самолеты' then //Если показывает все...
  begin
    ClientDataSet2.MasterFields := '';     //Показывает по компании
    BtnAllAir.Caption := 'По авиакомпании';
    exit;
  end;
  if BtnAllAir.Caption = 'По авиакомпании' then  //Иначе - наоборот
  begin
    ClientDataSet2.MasterFields := 'AirlineID';
    BtnAllAir.Caption := 'Все самолеты';
    exit;
  end;
end;

//Аналогично самолетам, принадлежность рейса...
procedure TFormAir.BtnAllFlightsClick(Sender: TObject);
begin
  if BtnAllFlights.Caption = 'Все рейсы' then //Если показывает все...
  begin
    ClientDataSet3.MasterFields := '';     //Показывает по самолетам
    BtnAllFlights.Caption := 'По самолетам';
    exit;
  end;
  if BtnAllFlights.Caption = 'По самолетам' then  //Иначе - наоборот
  begin
    ClientDataSet3.MasterFields := 'AircraftID';
    BtnAllFlights.Caption := 'Все рейсы';
    exit;
  end;
end;

//При закрытии программы также закрываем форму авторизации
procedure TFormAir.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  FormLog.Close;
end;

//Выход на форму пользователей
procedure TFormAir.MMUserOutClick(Sender: TObject);
begin
  FormAir.Hide;
  FormLog.Show;
end;

//Открытие формы-редактора на добавление
procedure TFormAir.MMAddClick(Sender: TObject);
begin
  FormAED.Show;
  FormAED.Caption := 'Добавление';  //Изменение названия формы-редатора
end;

//Выход из программы
procedure TFormAir.MMExitProgClick(Sender: TObject);
begin
  FormAir.Close;
end;

end.
