{% extends "bootstrap/base.html" %}

<head>
    <link rel="icon" href="data:;base64,=">
    <link href="../../resource/favicon.ico" rel="icon" type="image/x-icon" />
    <link href="../../resource/favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <link href="../../static/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../static/css/fancybox/jquery.fancybox.css" rel="stylesheet">
    <link href="../../static/css/flexslider.css" rel="stylesheet" />
    <link href="../../static/css/style.css" rel="stylesheet" />

   <!-- Script
   ================================================== -->
	<script src="../../static/js/modernizr.js"></script>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.31.1/jquery.min.js"></script>

</head>

{% block title %}
    {% if title %}{{ title }} - Check Accounting{% else %}–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è{% endif %}
    <link rel="stylesheet" href="{{ url_for('static', filename='site.css') }}">
    <link rel="icon" href="data:;base64,=">
    <link href="../../resource/favicon.ico" rel="icon" type="image/x-icon" />
    <link href="../../resource/favicon.ico" rel="shortcut icon" type="image/x-icon" />
{% endblock %}

{% block navbar %}
    <div class="loaderArea">
        <div class="loader"></div>
    </div>

    <nav class="navbar navbar-default">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>

            <a class="navbar-brand" rel="home" href="#" title="Check accounting">
                <img style="max-width:100px; margin-top: -7px;"
                    src="/static/favicon.ico">
            </a>

            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li><a href="{{ url_for('index') }}">–î–æ–º–∞—à–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</a></li>
                    <li><a href="{{ url_for('about') }}">–û —Å–∞–π—Ç–µ</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    {% if current_user.is_anonymous %}
                        <li><a href="{{ url_for('login') }}">–í–æ–π—Ç–∏</a></li>
                        <li><a href="{{ url_for('register') }}">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></li>
                    {% else %}
                        <li><a href="{{ url_for('user', public_id=current_user.public_id) }}">–ü—Ä–∏–≤–µ—Ç, {{ current_user.username }}</a></li>
                        <li><a href="{{ url_for('user', public_id=current_user.public_id) }}">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
                        <li><a href="{{ url_for('logout') }}">–í—ã–π—Ç–∏</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
    <link href="../../static/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../static/css/fancybox/jquery.fancybox.css" rel="stylesheet">
    <link href="../../static/css/flexslider.css" rel="stylesheet" />
    <link href="../../static/css/style.css" rel="stylesheet" />
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
{% endblock %}

{% block content %}
    <style>
        .container {
            width:1320px
        }

        .styled-select select {
            background: transparent;
            width: 268px;
            padding: 5px;
            font-size: 16px;
            border: 1px solid #ccc;
            height: 34px;
        }

        .styled-select {
            width: 240px;
            height: 34px;
            overflow: hidden;
            background: url(../../static/img/back_arrow.png) no-repeat right #ddd;
        }
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        .date {
            opacity: 1;
            background-size: contain;
        }
        .label {
            text-align: center;
            vertical-align: center;
        }

        .wrapper {
            vertical-align: middle;
        }

        .label, .wrapper{
            display: table-cell;
            vertical-align: middle;
        }

        .taxon {
            display: table-row;
            overflow: hidden;
            outline: 1px dotted deepskyblue;
            text-align: left;
            border-spacing: 5px;
        }

        .text-cell {
            display: table-cell;
            vertical-align: middle;
            text-align: center;
        }
    </style>

    <div class="container">
        <br>

        <div class="left-menu-col">
        <form name="check_excel" action="{{ url_for('detail_range', public_id=user.public_id) }}" method="post" enctype="multipart/form-data">
            <div class="row">
            <div class="col-md-4">
                <section>
				    <select class="styled-select" id="select_data" name="select_data" onchange="selectData()">
					    <option value="all_time">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
					    <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
					    <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
					    <option value="year">–ó–∞ –≥–æ–¥</option>
					    <option value="range">–í—ã–±–æ—Ä–æ—á–Ω–æ</option>
				    </select>
			    </section>
            </div>

            <div class="col-md-2">
                <input type="date" required="required" class="date" id="start_date" name="start_date">
            </div>

            <div class="col-md-2">
                <input type="date" required="required" class="date" id="final_date" name="final_date">
            </div>

            <div class="col-md-4">
                <input id="submit_detail_range" class="btn btn-primary" type="submit" value="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" hidden="hidden" name="submit_detail_range">
            </div>
        </div>

        <div class="row">
            <div class="col-md-3">
                <h4>–°–∫–∞—á–∞—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:</h4>
            </div>


            <div class="col-md-1">
                <a id="detail_excel" class="btn btn-primary" href="{{ url_for('detail_excel_all_time', public_id=user.public_id ) }}">Excel</a>
                <input id="submit_detail_excel" class="btn btn-primary" type="submit" value="Excel" hidden="hidden" name="submit_detail_excel">
            </div>


            <div class="col-md-1">
                <a id="detail_word" class="btn btn-primary" href="{{ url_for('detail_word_all_time', public_id=user.public_id ) }}">Word</a>
                <input id="submit_detail_word" class="btn btn-primary" type="submit" value="Word" hidden="hidden" name="submit_detail_word">
            </div>

            <div class="col-md-4">
                <p>„ÉΩÔΩÄ„ÄÅ„ÉΩÔΩÄÔΩÄ„ÄÅ„ÉΩÔΩÄ„ÉΩÔΩÄ„ÄÅ„ÄÅ„ÉΩ ÔΩÄ„ÉΩ „ÄÅ„ÉΩÔΩÄüåôÔΩÄ„ÉΩ„ÉΩÔΩÄ„ÉΩ„ÄÅ„ÉΩÔΩÄ„ÉΩÔΩÄ„ÄÅ„ÉΩÔΩÄÔΩÄ„ÄÅ„ÉΩ „ÄÅÔΩÄÔΩÄ„ÄÅ ÔΩÄ„ÄÅÔΩÄ „ÄÅÔΩÄ „ÉΩÔΩÄ„ÉΩ„ÄÅ</p>
            </div>

            <div class="col-md-3">
                <a class="btn btn-primary" href="{{ url_for('compare_information_week', public_id=user.public_id) }}">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é</a>
            </div>
        </div>

            <input type="checkbox" id="word" name="word" hidden="hidden">
            <input type="checkbox" id="sample_type" name="sample_type" hidden="hidden">
    </form>

        <ul class="wrapper" style="width: 400px;">
            {% for category_type in dict_category_types %}
                <li class="taxon ">
                    <label class="text-cell">{{ category_type }}</label>

                    {% for product_categories in dict_category_types.values() %}
                        {% if dict_category_types[category_type] == product_categories %}

                            <ul class="wrapper" style="width: 350px;">

                                {% for list_product_category in product_categories %}
                                    {% for product_category in list_product_category %}

                                        <li class="taxon">
                                            <label class="text-cell">{{ product_category }}</label>
                                            <ul  class="wrapper" style="width: 300px;">

                                                {% for abstract_products in list_product_category.values() %}
                                                    {% if abstract_products == list_product_category[product_category] %}
                                                        {% for dict_abstract_product in abstract_products %}
                                                            {% for abstract_product in dict_abstract_product %}

                                                                <li class="taxon">
                                                                    <table id="product_table" class="simple-little-table" cellspacing='0' width="400">
                                                                        <tr>
                                                                            <td>
                                                                                <label class="text-cell">{{ abstract_product }}</label>
                                                                            </td>

                                                                            <td>
                                                                                <label class="text-cell">{{ dict_abstract_product[abstract_product] }}</label>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </li>

                                                            {% endfor %}
                                                        {% endfor %}
                                                    {% endif %}
                                                {% endfor %}

                                            </ul>
                                        </li>
                                        <p class="panel-info" style="vertical-align: text-bottom; text-align: center; background-color: #7F8289; color: #FFFFFF;">–ò—Ç–æ–≥–æ: {{ '{:.2f}'.format(total_costs_product_category[product_category]) }}</p>

                                    {% endfor %}
                                {% endfor %}

                            </ul>

                        {% endif %}
                    {% endfor %}

                </li>
                <p class="progress-bar-info" style="vertical-align: text-bottom; text-align: center; background-color: #0f0f0f; color: #FFFFFF;">–ò—Ç–æ–≥–æ: {{ '{:.2f}'.format(total_costs_category_type[category_type]) }}</p>
            {% endfor %}
        </ul>
        </div>

        <div class="right-menu-col">
            <h5 align="center">–ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–∫—Ç–æ–≤</h5>
            <hr>

            <ul>
                <li>
                    <p class="total-cost">–í—Å–µ–≥–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ: {{ '{:.2f}'.format(total_cost) }}—Ä.</p>
                </li>

                <li>
                    <p>–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: {{ '{:.2f}'.format(interested_facts[4]) }}—Ä. –∑–∞ {{ interested_facts[5] }} –º–µ—Å—è—Ü(-–∞/-–µ–≤)</p>
                </li>

                <hr width="70%" style="border-top: 1px dotted white">

                <li>
                    <p>–°–∞–º–∞—è –¥–æ—Ä–æ–≥–∞—è –ø–æ–∫—É–ø–∫–∞ "{{ interested_facts[0] }}" –Ω–∞ —Å—É–º–º—É {{ '{:.2f}'.format(interested_facts[1]) }}—Ä.</p>
                </li>

                <li>
                    <p>–°–∞–º–∞—è –¥–µ—à–µ–≤–∞—è –ø–æ–∫—É–ø–∫–∞: {{ interested_facts[2] }} –Ω–∞ —Å—É–º–º—É {{ '{:.2f}'.format(interested_facts[3]) }}—Ä.</p>
                </li>

                <hr width="70%" style="border-top: 1px dotted white">

                <li>
                    <p>–ù–∞–∏–±–æ–ª—å—à–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "{{ interested_facts[6] }}" –Ω–∞ —Å—É–º–º—É {{ '{:.2f}'.format(interested_facts[7]) }}—Ä.</p>
                </li>

                <li>
                    <p>–ù–∞–∏–º–µ–Ω—å—à–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "{{ interested_facts[8] }}" –Ω–∞ —Å—É–º–º—É {{ '{:.2f}'.format(interested_facts[9]) }}—Ä.</p>
                </li>

                 <li>
                    <p>–ù–∞–∏–±–æ–ª—å—à–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –≤ —Å–µ–∫—Ü–∏–∏ "{{ interested_facts[10] }}" –Ω–∞ —Å—É–º–º—É {{ '{:.2f}'.format(interested_facts[11]) }}—Ä.</p>
                </li>

                <li>
                    <p>–ù–∞–∏–º–µ–Ω—å—à–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –≤ —Å–µ–∫—Ü–∏–∏ "{{ interested_facts[12] }}" –Ω–∞ —Å—É–º–º—É {{ '{:.2f}'.format(interested_facts[13]) }}—Ä.</p>
                </li>
            </ul>

            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
        </div>

        <div style="position: relative; background-color: #FFFFFF; opacity: 0.90" id="chart_div">
        <canvas id="line_chart" width="1100" height="400"></canvas>

        <div class="row">
            <div class="col-md-6">
                <canvas id="pie_chart" width="600" height="500"></canvas>
            </div>

            <div class="col-md-6">
                <canvas id="doughnut_chart" width="600" height="500"></canvas>
            </div>
        </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src='../../static/Chart.min.js'></script>
    <script type="text/javascript">

        Chart.defaults.global.responsive = false;

        var chart_line_data = {
                labels :
                    [{% for item in labels %}
                        "{{item}}",
                    {% endfor %}],
                datasets : [{
                    label: '{{ legend }}',
                    fill: true,
                    lineTension: 0.1,
                    backgroundColor: "rgba(75,192,192,0.4)",
                    borderColor: "rgba(75,192,192,1)",
                    borderCapStyle: 'butt',
                    borderDash: [],
                    borderDashOffset: 0.0,
                    borderJoinStyle: 'miter',
                    pointBorderColor: "rgba(75,192,192,1)",
                    pointBackgroundColor: "#fff",
                    pointBorderWidth: 1,
                    pointHoverRadius: 5,
                    pointHoverBackgroundColor: "rgba(75,192,192,1)",
                    pointHoverBorderColor: "rgba(220,220,220,1)",
                    pointHoverBorderWidth: 2,
                    pointRadius: 1,
                    pointHitRadius: 10,
                    data :
                        [{% for item in values %}
                            {{ item }},
                        {% endfor %}],
                    spanGaps: false
                }]
        };

        var chart_line_element = document.getElementById("line_chart").getContext("2d");

        var line_chart = new Chart(chart_line_element, {
            type: 'line',
            data: chart_line_data,
        });

        var chart_pie_data = {
                labels :
                    [{% for item in labels_pie %}
                        "{{item }}",
                    {% endfor %}],
                datasets : [{
                    label: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤',
                    fill: true,
                    lineTension: 0.1,
                    backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9",
              "#c45850", "#000", "#FFB6C1", "#DC143C",
              "#FFF0F5", "#8B008B", "#4B0082", "#0000FF",
              "#5F9EA0", "#00FFFF", "#008B8B", "#2F4F4F",
              "#7FFFD4", "#556B2F", "#808000", "#BDB76B",
              "#FFD700", "#B8860B", "#FF8C00", "#8B4513",
              "#FF4500", "#FFFAFA",
                        "#3e95cd", "#8e5ea2", "rgba(75,192,192,0.4)"],
                    borderColor: ["#3cba9f","#e8c3b9", "rgba(75,192,192,1)"],
                    borderCapStyle: 'butt',
                    borderDash: [],
                    borderDashOffset: 0.0,
                    borderJoinStyle: 'miter',
                    pointBorderColor: ["#8e5ea2", "rgba(75,192,192,1)", "#c45850"],
                    pointBackgroundColor: "#fff",
                    pointBorderWidth: 1,
                    pointHoverRadius: 5,
                    pointHoverBackgroundColor: "rgba(75,192,192,1)",
                    pointHoverBorderColor: "rgba(220,220,220,1)",
                    pointHoverBorderWidth: 2,
                    pointRadius: 1,
                    pointHitRadius: 10,
                    data :
                        [{% for item in values_pie %}
                            {{ item }},
                        {% endfor %}],
                    spanGaps: false
                }]
        };

        var chart_pie_element = document.getElementById("pie_chart").getContext("2d");

        var pie_chart = new Chart(chart_pie_element, {
            type: 'pie',
            data: chart_pie_data,
            options: {
                title: {
                    display: true,
                    text: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤'
                },
                responsive: true,
                hover: {
                                mode: 'point',
                                intersect: false
                            },
            }
        });

        var chart_doughnut_element = document.getElementById("doughnut_chart").getContext("2d");

        var doughnut_chart = new Chart(chart_doughnut_element,{
            type: 'doughnut',
            data: {
                labels: [
                    {% for type in values_radar %}
                        "{{ type[1] }}",
                    {% endfor %}
                ],
            datasets: [
            {
                label: "–¢–∏–ø—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤",
                backgroundColor: [
                    "#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9",
                    "#c45850", "#000", "#FFB6C1", "#DC143C",
                    "#FFF0F5", "#8B008B", "#4B0082", "#0000FF",
                    "#5F9EA0", "#00FFFF", "#008B8B", "#2F4F4F",
                    "#7FFFD4", "#556B2F", "#808000", "#BDB76B",
                    "#FFD700", "#B8860B", "#FF8C00", "#8B4513",
                    "#FF4500", "#FFFAFA",
                ],
                data: [
                    {% for type in values_radar %}
                        "{{ type[2] }}",
                    {% endfor %}
                ]
              }
            ]
          },
          options: {
            title: {
              display: true,
              text: '–¢–∏–ø—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤'
            }
          }
      });

      function selectData() {
          document.getElementById('start_date').style.display = 'none';
          document.getElementById('final_date').style.display = 'none';

          var detail_excel = $("#detail_excel");
          var detail_word = $("#detail_word");
          var detail_range = $("#submit_detail_range");

          $(detail_excel).show();
          $('#submit_detail_excel').hide();

          $(detail_range).hide();

          $(detail_word).show();
          $('#submit_detail_word').hide();

          switch (document.getElementById('select_data').value) {
              case 'all_time':
                  $(detail_excel).attr("href", "{{ url_for('detail_excel_all_time', public_id=user.public_id) }}");
                  $(detail_word).attr("href", "{{ url_for('detail_word_all_time', public_id=user.public_id) }}");
                  break;
              case 'week':
                  $(detail_excel).attr("href", "{{ url_for('detail_excel_week', public_id=user.public_id) }}");
                  $(detail_word).attr("href", "{{ url_for('detail_word_week', public_id=user.public_id) }}");
                  break;
              case 'month':
                  $(detail_excel).attr("href", "{{ url_for('detail_excel_month', public_id=user.public_id) }}");
                  $(detail_word).attr("href", "{{ url_for('detail_word_month', public_id=user.public_id) }}");
                  break;
              case 'year':
                  $(detail_excel).attr("href", "{{ url_for('detail_excel_year', public_id=user.public_id) }}");
                  $(detail_word).attr("href", "{{ url_for('detail_word_year', public_id=user.public_id) }}");
                  break;
              case 'range':
                  document.getElementById('start_date').style.display = 'block';
                  document.getElementById('final_date').style.display = 'block';

                  $(detail_excel).hide();
                  $('#submit_detail_excel').show();

                  $(detail_word).hide();
                  $('#submit_detail_word').show();

                  $('#submit_detail_range').show();

                  break;
          }
      }

      $(document).ready(function() {
          selectData();
          document.getElementById('select_data').value = '{{ sample_type }}';
          if ('{{ sample_type }}' == 'range') {
              document.getElementById('start_date').style.display = 'block';
                  document.getElementById('final_date').style.display = 'block';
                  document.getElementById('submit_detail_range').style.display = 'block';
          }

          $("#submit_detail_word").click(function () {
              $("#word").prop('checked', true);
              $("#sample_type").prop('checked', false);
          });

          $("#submit_detail_excel").click(function () {
              $("#word").prop('checked', false);
              $("#sample_type").prop('checked', false);
          });

          $("#submit_detail_range").click(function () {
              $("#sample_type").prop('checked', true);
          });

          $('#select_data').change(function () {
              switch (document.getElementById('select_data').value) {
                  case 'all_time':
                       location.href = '{{ url_for('detail_information_all_time', public_id=user.public_id) }}';
                       break;
                   case 'week':
                       location.href = '{{ url_for('detail_information_week', public_id=user.public_id) }}';
                       break;
                   case 'month':
                       location.href = '{{ url_for('detail_information_month', public_id=user.public_id) }}';
                       break;
                   case 'year':
                       location.href = '{{ url_for('detail_information_year', public_id=user.public_id) }}';
                       break;
                   case 'range':
                       document.getElementById('start_date').style.display = 'block';
                       document.getElementById('final_date').style.display = 'block';
                       document.getElementById('submit_detail_range').style.display = 'block';
                       break;
                   }
            });

          $('.right-menu-col').mouseenter(function () {
              var c_d_o = 1;


              var timerId = setInterval(function() {
                  $('#chart_div').css("opacity", c_d_o);

                  c_d_o -= 0.05
              }, 50);

              setTimeout(function() {
                  clearInterval(timerId);
              }, 1050);
          });

          $('.right-menu-col').mouseleave(function () {
              var c_d_o = 0.05;

              var timerId = setInterval(function() {
                  $('#chart_div').css("opacity", c_d_o);

                  c_d_o += 0.05
              }, 50);

              setTimeout(function() {
                  clearInterval(timerId);
              }, 1050);
          });
      });

      $(window).on('load', function () {
          $preloader = $('.loaderArea'),
              $loader = $preloader.find('.loader');
          $loader.fadeOut();
          $preloader.delay(350).fadeOut('slow');
      });

    </script>

    {% include "footer.html" %}

{% endblock %}
<body>